import{r as o,S as Pe,B as ne,c as re,u as N,d as ge,o as te,m as pe,a5 as _e,P as je,g as we,n as Oe,z as qe,x as Y}from"./index-BsM-neoq.js";import{L as xe}from"./Label-DVLxoNMg.js";import{I as Re}from"./Input-BIcjEkln.js";import{T as We}from"./Textarea-LKCAdoGf.js";import{I as ke}from"./Icon-JMgRki_A.js";import{I as ce}from"./InputWithDecorations-7sKfE52B.js";import{M as He}from"./MenuExtraContent-B4brTU5P.js";import{a as Ke,I as de,b as Ue,A as Ge,S as se}from"./Select-C3W9rGUf.js";import{T as Ye}from"./Text-CdeXuzI4.js";import{u as Je}from"./Popover-54JxWjdK.js";import{S as Qe}from"./SvgCaretDownSmall-D1DqE4qB.js";import{u as Xe}from"./useContainerWidth-DNCnqFLt.js";import{L as Ze}from"./List-CVuVSj-3.js";import{L as Z}from"./ListItem-BqZ5uioC.js";import{S as et}from"./SvgCheckmark-utXYliQY.js";const fe=o.forwardRef((s,a)=>{const{children:e,startIcon:t,status:n,className:r,iconProps:l,contentProps:i,...u}=s,d=t??(n&&Pe[n]()),f=t!==null&&!!d;return o.createElement(ne,{className:re("iui-status-message",r),"data-iui-status":n,ref:a,...u},f?o.createElement(ke,{"aria-hidden":!0,...l},d):null,o.createElement(ne,{...i},e))}),tt=o.forwardRef((s,a)=>{const{label:e,disabled:t,required:n,status:r,message:l,icon:i,isLabelInline:u,children:d,className:f,style:p,statusMessage:g,inputId:m,labelId:x,...S}=s;return o.createElement(ne,{className:re("iui-input-grid",f),"data-iui-status":r,"data-iui-label-placement":u?"inline":void 0,style:p,ref:a,...S},e&&o.createElement(xe,{as:m&&s.as!=="label"?"label":"div",required:n,disabled:t,htmlFor:m,id:x},e),d,g||l&&o.createElement(fe,{startIcon:i,status:r},l))}),nt=(s,a)=>{switch(a.type){case"open":return{...s,isOpen:!0};case"close":return{...s,isOpen:!1};case"select":return Array.isArray(s.selected)?{...s}:{...s,selected:a.value??s.selected,focusedIndex:a.value??s.focusedIndex};case"multiselect":return Array.isArray(s.selected)?{...s,selected:a.value}:{...s};case"focus":return Array.isArray(s.selected)?{...s,focusedIndex:a.value??-1}:{...s,focusedIndex:a.value??s.selected??-1};default:return s}},ie=o.createContext(void 0);ie.displayName="ComboBoxRefsContext";const H=o.createContext(void 0);H.displayName="ComboBoxStateContext";const Ie=o.createContext(void 0);Ie.displayName="ComboBoxActionContext";const Te=o.forwardRef((s,a)=>{const{className:e,children:t,disabled:n,isOpen:r,...l}=s;return o.createElement(ke,{as:"span",ref:a,className:re("iui-end-icon",{"iui-disabled":n,"iui-open":r},e),...l},t??o.createElement(Qe,{"aria-hidden":!0}))});Te.displayName="ComboBoxEndIcon";const Be=o.forwardRef((s,a)=>{const{selectedItems:e=[],...t}=s;return o.createElement(Ke,{ref:a,tags:e,...t})});Be.displayName="ComboBoxMultipleContainer";const De=o.forwardRef((s,a)=>{const{selectTags:e,size:t,style:n,...r}=s,{isOpen:l,id:i,focusedIndex:u,enableVirtualization:d,multiple:f,onClickHandler:p,popover:g,show:m,hide:x}=N(H),S=N(Ie),{inputRef:k,menuRef:I,optionsExtraInfoRef:O}=N(ie),me=ge(k,g.refs.setReference,a),y=te(u??-1),C=R=>{var B,D;return((D=(B=I.current)==null?void 0:B.querySelector(`[data-iui-index="${R}"]`))==null?void 0:D.id)??""},$=o.useCallback(R=>{var D,L,K,P,_,Q,oe,le,ae,j;const B=Object.keys(O.current).length??0;if(!R.altKey)switch(R.key){case"ArrowDown":{if(R.preventDefault(),!l)return m();if(B===0)return;if(y.current===-1){const M=(D=I.current)==null?void 0:D.querySelector("[data-iui-index]");return S({type:"focus",value:Number((M==null?void 0:M.getAttribute("data-iui-index"))??0)})}if(d&&!((K=(L=I.current)==null?void 0:L.querySelector(`[data-iui-index="${y.current}"]`))!=null&&K.nextElementSibling))return;let T=y.current;do{const M=(P=I.current)==null?void 0:P.querySelector(`[data-iui-index="${T}"]`),w=(M==null?void 0:M.nextElementSibling)??((_=I.current)==null?void 0:_.querySelector("[data-iui-index]"));if(T=Number(w==null?void 0:w.getAttribute("data-iui-index")),w)return S({type:"focus",value:T})}while(T!==y.current);break}case"ArrowUp":{if(R.preventDefault(),!l)return m();if(B===0||d&&!((oe=(Q=I.current)==null?void 0:Q.querySelector(`[data-iui-index="${y.current}"]`))!=null&&oe.previousElementSibling))return;if(y.current===-1)return S({type:"focus",value:((le=Object.values(O.current))==null?void 0:le[B-1].__originalIndex)??-1});let T=y.current;do{const M=(ae=I.current)==null?void 0:ae.querySelector(`[data-iui-index="${T}"]`),w=(M==null?void 0:M.previousElementSibling)??((j=I.current)==null?void 0:j.querySelector("[data-iui-index]:last-of-type"));if(T=Number(w==null?void 0:w.getAttribute("data-iui-index")),w)return S({type:"focus",value:T})}while(T!==y.current);break}case"Enter":{R.preventDefault(),l?y.current>-1&&(p==null||p(y.current)):m();break}case"Escape":{R.preventDefault(),x();break}case"Tab":x();break}},[S,d,y,l,I,p,O,m,x]),J=o.useRef(!1),F=o.useCallback(()=>{J.current=l},[l]),v=o.useCallback(()=>{J.current?x():m(),J.current=!1},[x,m]),[A,z]=Xe();return o.createElement(o.Fragment,null,o.createElement(Re,{ref:me,"aria-expanded":l,"aria-activedescendant":l&&u!=null&&u>-1?C(u):void 0,role:"combobox","aria-controls":l?`${i}-list`:void 0,"aria-autocomplete":"list",spellCheck:!1,autoCapitalize:"none",autoCorrect:"off",style:{...f&&{paddingInlineStart:z+18},...n},"aria-describedby":f?`${i}-selected-live`:void 0,size:t,...g.getReferenceProps({...r,onPointerDown:pe(s.onPointerDown,F),onClick:pe(s.onClick,v),onKeyDown:pe(s.onKeyDown,$)})}),f&&e?o.createElement(Be,{ref:A,selectedItems:e,id:`${i}-selected-live`}):null)});De.displayName="ComboBoxInput";const Ae=o.forwardRef((s,a)=>{const{className:e,status:t,message:n,children:r,...l}=s,{id:i}=N(H);return o.createElement(tt,{className:e,status:t,statusMessage:typeof n=="string"?o.createElement(fe,{status:t},n):o.isValidElement(n)&&o.cloneElement(n,{status:t}),ref:a,...l,id:i},o.createElement(de,null,r))});Ae.displayName="ComboBoxInputContainer";function ee(s,a,e){let t=e.initialDeps??[],n;return()=>{var r,l,i,u;let d;e.key&&((r=e.debug)!=null&&r.call(e))&&(d=Date.now());const f=s();if(!(f.length!==t.length||f.some((m,x)=>t[x]!==m)))return n;t=f;let g;if(e.key&&((l=e.debug)!=null&&l.call(e))&&(g=Date.now()),n=a(...f),e.key&&((i=e.debug)!=null&&i.call(e))){const m=Math.round((Date.now()-d)*100)/100,x=Math.round((Date.now()-g)*100)/100,S=x/16,k=(I,O)=>{for(I=String(I);I.length<O;)I=" "+I;return I};console.info(`%c⏱ ${k(x,5)} /${k(m,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*S,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(u=e==null?void 0:e.onChange)==null||u.call(e,n),n}}function be(s,a){if(s===void 0)throw new Error(`Unexpected undefined${a?`: ${a}`:""}`);return s}const st=(s,a)=>Math.abs(s-a)<1,rt=(s,a)=>{let e;return function(...t){clearTimeout(e),e=setTimeout(()=>s.apply(this,t),a)}},it=s=>s,ot=s=>{const a=Math.max(s.startIndex-s.overscan,0),e=Math.min(s.endIndex+s.overscan,s.count-1),t=[];for(let n=a;n<=e;n++)t.push(n);return t},lt=(s,a)=>{const e=s.scrollElement;if(!e)return;const t=r=>{const{width:l,height:i}=r;a({width:Math.round(l),height:Math.round(i)})};if(t(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const n=new ResizeObserver(r=>{const l=r[0];if(l!=null&&l.borderBoxSize){const i=l.borderBoxSize[0];if(i){t({width:i.inlineSize,height:i.blockSize});return}}t(e.getBoundingClientRect())});return n.observe(e,{box:"border-box"}),()=>{n.unobserve(e)}},Me={passive:!0},at=typeof window>"u"?!0:"onscrollend"in window,ut=(s,a)=>{const e=s.scrollElement;if(!e)return;let t=0;const n=at?()=>{}:rt(()=>{a(t,!1)},s.options.isScrollingResetDelay),r=u=>()=>{t=e[s.options.horizontal?"scrollLeft":"scrollTop"],n(),a(t,u)},l=r(!0),i=r(!1);return i(),e.addEventListener("scroll",l,Me),e.addEventListener("scrollend",i,Me),()=>{e.removeEventListener("scroll",l),e.removeEventListener("scrollend",i)}},ct=(s,a,e)=>{if(a!=null&&a.borderBoxSize){const t=a.borderBoxSize[0];if(t)return Math.round(t[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(s.getBoundingClientRect()[e.options.horizontal?"width":"height"])},dt=(s,{adjustments:a=0,behavior:e},t)=>{var n,r;const l=s+a;(r=(n=t.scrollElement)==null?void 0:n.scrollTo)==null||r.call(n,{[t.options.horizontal?"left":"top"]:l,behavior:e})};class ft{constructor(a){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(n=>{n.forEach(r=>{this._measureElement(r.target,r)})}):null);return{disconnect:()=>{var n;return(n=t())==null?void 0:n.disconnect()},observe:n=>{var r;return(r=t())==null?void 0:r.observe(n,{box:"border-box"})},unobserve:n=>{var r;return(r=t())==null?void 0:r.unobserve(n)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,n])=>{typeof n>"u"&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:it,rangeExtractor:ot,onChange:()=>{},measureElement:ct,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...e}},this.notify=(e,t)=>{var n,r;const{startIndex:l,endIndex:i}=this.range??{startIndex:void 0,endIndex:void 0},u=this.calculateRange();(e||l!==(u==null?void 0:u.startIndex)||i!==(u==null?void 0:u.endIndex))&&((r=(n=this.options).onChange)==null||r.call(n,this,t))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(t,n)=>{this.scrollAdjustments=0,this.scrollDirection=n?this.scrollOffset<t?"forward":"backward":null,this.scrollOffset=t;const r=this.isScrolling;this.isScrolling=n,this.notify(r!==n,n)})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=ee(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,t,n,r)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:r}),{key:!1}),this.getFurthestMeasurement=(e,t)=>{const n=new Map,r=new Map;for(let l=t-1;l>=0;l--){const i=e[l];if(n.has(i.lane))continue;const u=r.get(i.lane);if(u==null||i.end>u.end?r.set(i.lane,i):i.end<u.end&&n.set(i.lane,!0),n.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((l,i)=>l.end===i.end?l.index-i.index:l.end-i.end)[0]:void 0},this.getMeasurements=ee(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:n,getItemKey:r},l)=>{const i=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const u=this.measurementsCache.slice(0,i);for(let d=i;d<e;d++){const f=r(d),p=this.options.lanes===1?u[d-1]:this.getFurthestMeasurement(u,d),g=p?p.end+this.options.gap:t+n,m=l.get(f),x=typeof m=="number"?m:this.options.estimateSize(d),S=g+x,k=p?p.lane:d%this.options.lanes;u[d]={index:d,start:g,size:x,end:S,key:f,lane:k}}return this.measurementsCache=u,u},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ee(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,t,n)=>this.range=e.length>0&&t>0?mt({measurements:e,outerSize:t,scrollOffset:n}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=ee(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,t,n,r)=>t===null?[]:e({startIndex:t.startIndex,endIndex:t.endIndex,overscan:n,count:r}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const n=this.measurementsCache[this.indexFromElement(e)];if(!n||!e.isConnected){this.measureElementCache.forEach((i,u)=>{i===e&&(this.observer.unobserve(e),this.measureElementCache.delete(u))});return}const r=this.measureElementCache.get(n.key);r!==e&&(r&&this.observer.unobserve(r),this.observer.observe(e),this.measureElementCache.set(n.key,e));const l=this.options.measureElement(e,t,this);this.resizeItem(n,l)},this.resizeItem=(e,t)=>{const n=this.itemSizeCache.get(e.key)??e.size,r=t-n;r!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(e,r,this):e.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=r,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,t)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=ee(()=>[this.getIndexes(),this.getMeasurements()],(e,t)=>{const n=[];for(let r=0,l=e.length;r<l;r++){const i=e[r],u=t[i];n.push(u)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();return be(t[Ne(0,t.length-1,n=>be(t[n]).start,e)])},this.getOffsetForAlignment=(e,t)=>{const n=this.getSize();t==="auto"&&(e<=this.scrollOffset?t="start":e>=this.scrollOffset+n?t="end":t="start"),t==="start"?e=e:t==="end"?e=e-n:t==="center"&&(e=e-n/2);const r=this.options.horizontal?"scrollWidth":"scrollHeight",i=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[r]:this.scrollElement[r]:0)-this.getSize();return Math.max(Math.min(i,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=be(this.getMeasurements()[e]);if(t==="auto")if(n.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)t="end";else if(n.start<=this.scrollOffset+this.options.scrollPaddingStart)t="start";else return[this.scrollOffset,t];const r=t==="end"?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(r,t),t]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[r,l]=this.getOffsetForIndex(e,t);this._scrollToOffset(r,{adjustments:void 0,behavior:n}),n!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[u]=this.getOffsetForIndex(e,l);st(u,this.scrollOffset)||this.scrollToIndex(e,{align:l,behavior:n})}else this.scrollToIndex(e,{align:l,behavior:n})}))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;return t.length===0?n=this.options.paddingStart:n=this.options.lanes===1?((e=t[t.length-1])==null?void 0:e.end)??0:Math.max(...t.slice(-this.options.lanes).map(r=>r.end)),n-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{var e,t;this.itemSizeCache=new Map,(t=(e=this.options).onChange)==null||t.call(e,this,!1)},this.setOptions(a),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.notify(!1,!1)}}const Ne=(s,a,e,t)=>{for(;s<=a;){const n=(s+a)/2|0,r=e(n);if(r<t)s=n+1;else if(r>t)a=n-1;else return n}return s>0?s-1:0};function mt({measurements:s,outerSize:a,scrollOffset:e}){const t=s.length-1,r=Ne(0,t,i=>s[i].start,e);let l=r;for(;l<t&&s[l].end<e+a;)l++;return{startIndex:r,endIndex:l}}const ht=typeof document<"u"?o.useLayoutEffect:o.useEffect;function pt(s){const a=o.useReducer(()=>({}),{})[1],e={...s,onChange:(n,r)=>{var l;r?_e.flushSync(a):a(),(l=s.onChange)==null||l.call(s,n,r)}},[t]=o.useState(()=>new ft(e));return t.setOptions(e),o.useEffect(()=>t._didMount(),[]),ht(()=>t._willUpdate()),t}function bt(s){return pt({observeElementRect:lt,observeElementOffset:ut,scrollToFn:dt,...s})}const gt=s=>{const{children:a,...e}=s,{filteredOptions:t,getMenuItem:n,focusedIndex:r}=N(H),{menuRef:l}=N(ie),i=bt({count:t.length||1,getScrollElement:()=>l.current,estimateSize:()=>36,gap:-1}),u=o.useCallback(f=>{const p=t.length>0?n(t[f.index],f.index):a;return o.cloneElement(p,{key:f.key,"data-index":f.index,ref:i.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${f.start}px)`}})},[t,n,a,i.measureElement]),d=o.useMemo(()=>{var p;const f=(p=l.current)==null?void 0:p.querySelector(`[data-iui-index="${r}"]`);return f?Number(f.getAttribute("data-iui-filtered-index")??r):r},[r,l]);return we(()=>{d&&i.scrollToIndex(d,{align:"auto"})},[d,i]),o.createElement(ne,{as:"div",...e,style:{minBlockSize:i.getTotalSize(),minInlineSize:"100%",...s.style}},i.getVirtualItems().map(f=>u(f)))},Ve=o.forwardRef((s,a)=>{const{className:e,children:t,style:n,...r}=s,{id:l,enableVirtualization:i,popover:u}=N(H),{menuRef:d}=N(ie),f=ge(u.refs.setFloating,a,d);return u.open&&o.createElement(je,{portal:!0},o.createElement(Ze,{as:"div",className:re("iui-menu",e),id:`${l}-list`,role:"listbox",ref:f,...u.getFloatingProps({style:i?{maxInlineSize:0,...n}:n,...r})},i?o.createElement(gt,null,t):t))});Ve.displayName="ComboBoxMenu";const $e=o.memo(o.forwardRef((s,a)=>{const{children:e,isSelected:t,disabled:n,value:r,onClick:l,sublabel:i,size:u=i?"large":"default",startIcon:d,endIcon:f,role:p="option",index:g,...m}=s,{focusedIndex:x,enableVirtualization:S}=N(H),I=ge(a,O=>{!S&&x===g&&(O==null||O.scrollIntoView({block:"nearest"}))});return o.createElement(Z,{as:"div",actionable:!0,size:u,active:t,disabled:n,focused:x===g,ref:I,onClick:()=>l==null?void 0:l(r),role:p,tabIndex:p==="presentation"?void 0:-1,"aria-selected":t,"aria-disabled":n,"data-iui-index":g,...m},d&&o.createElement(Z.Icon,{as:"span","aria-hidden":!0},d),o.createElement(Z.Content,null,e,i&&o.createElement(Z.Description,null,i)),f||t&&o.createElement(Z.Icon,{as:"span","aria-hidden":!0},f??o.createElement(et,null)))}));$e.displayName="ComboBoxMenuItem";const G=(s,a)=>a&&(Array.isArray(s)||s===void 0),xt=(s,a)=>!a,ze=(s,a)=>s.id??`${a}-option-${s.label.replace(/\s/g,"-")}`,ye=o.forwardRef((s,a)=>{var Ee;const e=Oe(),{options:t,value:n,onChange:r,filterFunction:l,inputProps:i,endIconProps:u,dropdownMenuProps:d,emptyStateMessage:f="No options found",itemRenderer:p,enableVirtualization:g=!1,multiple:m=!1,onShow:x,onHide:S,id:k=i!=null&&i.id?`iui-${i.id}-cb`:e,...I}=s,O=o.useRef(null),me=o.useRef(null),y=te(r),C=te(t),$=o.useRef({});o.useEffect(()=>{$.current={}},[t]),t.length>0&&Object.keys($.current).length===0&&t.forEach((c,h)=>{$.current[ze(c,k)]={__originalIndex:h}});const J=o.useCallback(()=>{if(G(n,m)){const c=[];return n==null||n.forEach(h=>{const b=t.findIndex(E=>E.value===h);b>-1&&c.push(b)}),c}else return t.findIndex(c=>c.value===n)},[m,t,n]),[{isOpen:F,selected:v,focusedIndex:A},z]=o.useReducer(nt,{isOpen:!1,selected:J(),focusedIndex:-1}),R=te(x),B=te(S),D=o.useCallback(()=>{var c;z({type:"open"}),(c=R.current)==null||c.call(R)},[R]),L=o.useCallback(()=>{var c;z({type:"close"}),(c=B.current)==null||c.call(B)},[B]);we(()=>{var c,h;F?((c=O.current)==null||c.focus(),m||(P(C.current),z({type:"focus",value:void 0}))):(z({type:"focus",value:void 0}),G(v,m)||Q(v!=null&&v>=0?(h=C.current[v])==null?void 0:h.label:""))},[F,m,C,v]);const[K,P]=o.useState(t);o.useEffect(()=>{P(_?(l==null?void 0:l(t,_))??t.filter(c=>c.label.toLowerCase().includes(_.toLowerCase())):t),z({type:"focus",value:void 0})},[t]);const[_,Q]=o.useState(((Ee=i==null?void 0:i.value)==null?void 0:Ee.toString())??""),[oe,le]=o.useState(""),ae=o.useCallback(c=>{var b;const{value:h}=c.currentTarget;Q(h),D(),P((l==null?void 0:l(C.current,h))??C.current.filter(E=>E.label.toLowerCase().includes(h.toLowerCase()))),A!=-1&&z({type:"focus",value:-1}),(b=i==null?void 0:i.onChange)==null||b.call(i,c)},[l,A,i,C,D]);o.useEffect(()=>{if(G(n,m))if(n){const c=n.map(h=>t.findIndex(b=>b.value===h));z({type:"multiselect",value:c.filter(h=>h!==-1)})}else z({type:"multiselect",value:[]});else z({type:"select",value:t.findIndex(c=>c.value===n)})},[n,t,m]);const j=o.useCallback(c=>G(v,m)?!!v.includes(c):v===c,[m,v]),T=o.useCallback((c,h)=>h==="added"?[...v,c]:v.filter(b=>b!==c),[v]),M=o.useCallback((c,h,b)=>{var E,V,U,q;xt(y.current,m)?(V=y.current)==null||V.call(y,(E=C.current[c])==null?void 0:E.value):h&&b&&((q=y.current)==null||q.call(y,b==null?void 0:b.map(he=>{var W;return(W=C.current[he])==null?void 0:W.value}),{value:(U=C.current[c])==null?void 0:U.value,type:h}))},[m,y,C]),w=o.useCallback(c=>{var h,b;if((h=O.current)==null||h.focus({preventScroll:!0}),!((b=C.current[c])!=null&&b.disabled))if(G(v,m)){const E=j(c)?"removed":"added",V=T(c,E);z({type:"multiselect",value:V}),M(c,E,V),le(V.map(U=>{var q;return(q=C.current[U])==null?void 0:q.label}).filter(Boolean).join(", "))}else z({type:"select",value:c}),L(),M(c)},[T,j,m,M,v,C,L]),ve=o.useCallback((c,h)=>{const b=ze(c,k),{__originalIndex:E}=$.current[b],{icon:V,startIcon:U,...q}=c,he=U??V,W=p?p(c,{isFocused:A===E,isSelected:v===E,index:E,id:b}):null;return W?o.cloneElement(W,{onClick:X=>{var Ce,Se;w(E),(Se=(Ce=W.props).onClick)==null||Se.call(Ce,X)},focused:A===E,"data-iui-index":E,"data-iui-filtered-index":h,ref:qe(W.props.ref,X=>{!g&&A===E&&(X==null||X.scrollIntoView({block:"nearest"}))})}):o.createElement($e,{key:b,id:b,startIcon:he,...q,isSelected:j(E),onClick:()=>{w(E)},index:E,"data-iui-filtered-index":h},c.label)},[g,A,k,j,p,w,v]),Fe=o.useMemo(()=>o.createElement(o.Fragment,null,o.isValidElement(f)?f:o.createElement(He,null,o.createElement(Ye,{isMuted:!0},f))),[f]),Le=Je({visible:F,onVisibleChange:c=>c?D():L(),matchWidth:!0,closeOnOutsideClick:!0,interactions:{click:!1,focus:!0}});return o.createElement(ie.Provider,{value:{inputRef:O,menuRef:me,optionsExtraInfoRef:$}},o.createElement(Ie.Provider,{value:z},o.createElement(H.Provider,{value:{id:k,isOpen:F,focusedIndex:A,onClickHandler:w,enableVirtualization:g,filteredOptions:K,getMenuItem:ve,multiple:m,popover:Le,show:D,hide:L}},o.createElement(Ae,{ref:a,disabled:i==null?void 0:i.disabled,...I},o.createElement(o.Fragment,null,o.createElement(De,{value:_,disabled:i==null?void 0:i.disabled,...i,onChange:ae,selectTags:G(v,m)?v.map(c=>{const h=C.current[c];return o.createElement(Ue,{key:h.label,label:h.label})}):void 0})),o.createElement(Te,{...u,disabled:i==null?void 0:i.disabled,isOpen:F}),m?o.createElement(Ge,{text:oe}):null),o.createElement(Ve,{as:"div",...d},K.length>0&&!g?K.map(ve):Fe))))}),$t=o.forwardRef((s,a)=>{const{children:e,className:t,labelPlacement:n=void 0,...r}=s,l=It(e);return o.createElement(ne,{className:re("iui-input-grid",t),"data-iui-label-placement":n,ref:a,...r},l)}),It=s=>{const{labelId:a,inputId:e,messageId:t}=yt(s);return o.useMemo(()=>o.Children.map(s,n=>o.isValidElement(n)?n.type===xe||n.type==="label"?Y(n,r=>({...r.props,htmlFor:r.props.htmlFor||e,id:r.props.id||a})):n.type===fe?Y(n,r=>({...r.props,id:r.props.id||t})):ue(n)||n.type===ce||n.type===de?vt(n,{labelId:a,inputId:e,messageId:t}):n:n),[s,e,a,t])},yt=s=>{const a=Oe();let e,t,n,r=!1,l=!1;const i=u=>{var d;if(o.isValidElement(u)){if(u.type===ye)return((d=u.props.inputProps)==null?void 0:d.id)||`${a}--input`;if(u.type!==se)return u.props.id||`${a}--input`}};return o.Children.forEach(s,u=>{o.isValidElement(u)&&((u.type===xe||u.type==="label")&&(r=!0,e||(e=u.props.id||`${a}--label`)),u.type===fe&&(n||(n=u.props.id||`${a}--message`)),u.type===ce||u.type===de?o.Children.forEach(u.props.children,d=>{ue(d)&&(t||(t=i(d)))}):ue(u)&&(t||(t=i(u))),u.type===se&&(l=!0))}),{labelId:l?e:void 0,inputId:r&&!l?t:void 0,messageId:n}},vt=(s,{labelId:a,inputId:e,messageId:t})=>{const n=(l={})=>{const i=[l["aria-describedby"],t].filter(Boolean).join(" ");return{...l,...s.type!==se&&{id:l.id||e},"aria-describedby":(i==null?void 0:i.trim())||void 0}},r=l=>l.type===ye?Y(l,i=>({inputProps:n(i.props.inputProps)})):l.type===se?Y(l,i=>({triggerProps:{"aria-labelledby":a,...n(i.props.triggerProps)}})):Y(l,i=>n(i.props));return s.type===ce||s.type===de?Y(s,l=>({children:o.Children.map(l.props.children,i=>o.isValidElement(i)&&ue(i)?r(i):i)})):r(s)},ue=s=>o.isValidElement(s)&&(s.type==="input"||s.type==="textarea"||s.type==="select"||s.type===Re||s.type===We||s.type===ce.Input||s.type===se||s.type===ye);export{ye as C,$t as I,fe as S};
