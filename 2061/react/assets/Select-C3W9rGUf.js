import{p as re,r as e,h as W,V as ue,B as S,c as k,b as ce,d as M,m as H,n as ie,o as oe,P as de,a6 as me,a7 as fe}from"./index-BsM-neoq.js";import{M as be}from"./Menu-dmwNOltS.js";import{I as Ee}from"./Icon-JMgRki_A.js";import{u as ve}from"./Popover-54JxWjdK.js";import{L as ge}from"./List-CVuVSj-3.js";import{S as Se}from"./SvgCheckmark-utXYliQY.js";import{S as he}from"./SvgCaretDownSmall-D1DqE4qB.js";const L=re.div("iui-input-with-icon");L.displayName="InputWithIcon";const ye=({text:t=""})=>{const[s,a]=e.useState(t);return e.useEffect(()=>{var r;a(t);const l=(r=W())==null?void 0:r.setTimeout(()=>a(""),5e3);return()=>{var o;return void((o=W())==null?void 0:o.clearTimeout(l))}},[t]),e.createElement(ue,{as:"div","aria-live":"polite","aria-atomic":"true"},s)},K=e.forwardRef((t,s)=>{const{className:a,label:l,...r}=t;return e.createElement(S,{as:"span",className:k("iui-select-tag",a),ref:s,...r},e.createElement(S,{as:"span",className:"iui-select-tag-label"},l))}),pe=e.forwardRef((t,s)=>{const{tags:a,className:l,...r}=t,[o,f]=ce(a),m=M(s,o);return e.createElement(S,{className:k("iui-select-tag-container",l),ref:m,...r},e.createElement(e.Fragment,null,f<a.length?a.slice(0,f-1):a,f<a.length&&e.createElement(K,{label:`+${a.length-f+1} item(s)`})))}),Be=e.forwardRef((t,s)=>{const{native:a,...l}=t,r=a?Ce:Ne;return e.createElement(r,{...l,ref:s})}),Ce=e.forwardRef((t,s)=>{const{triggerProps:a,options:l,disabled:r,placeholder:o,defaultValue:f=o!==void 0?"":void 0,value:m,onChange:h,size:y,status:x,styleType:d,required:v,...b}=t;return e.createElement(L,{...b,ref:s},e.createElement(j,{as:"select",size:y,status:x,styleType:d,disabled:r,defaultValue:m===void 0?f:void 0,value:m===null?"":m,required:v,...a,onKeyDown:H(a==null?void 0:a.onKeyDown,c=>{var T,i;c.key==="Enter"&&((i=(T=c.currentTarget).showPicker)==null||i.call(T))}),onChange:H(a==null?void 0:a.onChange,c=>{h==null||h(c.currentTarget.value,c)})},d!=="borderless"&&o!==void 0?e.createElement("option",{value:"",disabled:!0},o):null,l.map(c=>e.createElement("option",{key:c.value,...c},c.label))),e.createElement(U,{disabled:r}))}),Ne=e.forwardRef((t,s)=>{const a=ie(),{options:l,value:r,onChange:o,placeholder:f,disabled:m=!1,size:h,itemRenderer:y,selectedItemRenderer:x,menuClassName:d,menuStyle:v,multiple:b=!1,triggerProps:c,status:T,popoverProps:i,styleType:G,...J}=t,[O,z]=e.useState(!1),[Q,X]=e.useState(""),[Y,$]=e.useState(),u=r!==void 0?r:Y,g=oe(o),q=e.useRef(null),Z=e.useCallback(()=>{var n;m||(z(!0),(n=i==null?void 0:i.onVisibleChange)==null||n.call(i,!0))},[m,i]),V=e.useCallback(()=>{var n,E;z(!1),(n=q.current)==null||n.focus({preventScroll:!0}),(E=i==null?void 0:i.onVisibleChange)==null||E.call(i,!1)},[i]),_=e.useMemo(()=>l.map((n,E)=>{const C=F(u,b)?(u==null?void 0:u.includes(n.value))??!1:u===n.value,A=y?y(n,{close:()=>z(!1),isSelected:C}):e.createElement(be,null,n.label),{label:te,icon:ae,startIcon:ne,...se}=n,le=ne??ae;return e.cloneElement(A,{key:`${te}-${E}`,isSelected:C,startIcon:le,endIcon:C?e.createElement(Se,{"aria-hidden":!0}):null,onClick:()=>{var R,D;if(!n.disabled&&(xe(g.current,b)?($(n.value),(R=g.current)==null||R.call(g,n.value),V()):($(N=>C?N==null?void 0:N.filter(B=>n.value!==B):[...N??[],n.value]),(D=g.current)==null||D.call(g,n.value,C?"removed":"added")),F(u,b))){const N=u||[],B=C?N.filter(I=>n.value!==I):[...N,n.value];X(l.filter(I=>B.includes(I.value)).map(I=>I.label).filter(Boolean).join(", "))}},ref:R=>{C&&!b&&(R==null||R.scrollIntoView({block:"nearest"}))},role:"option",...se,...A.props})}),[V,y,b,g,l,u]),p=e.useMemo(()=>{if(u!=null)return F(u,b)?l.filter(n=>u.some(E=>E===n.value)):l.find(n=>n.value===u)},[b,l,u]),P=e.useMemo(()=>{let n=0;return Array.isArray(u)&&u.length>0?n=l.findIndex(E=>E.value===u[0]):u&&(n=l.findIndex(E=>E.value===u)),n>=0?n:0},[l,u]),ee=e.useCallback(n=>e.createElement(K,{key:n.label,label:n.label}),[]),w=ve({visible:O,matchWidth:!0,closeOnOutsideClick:!0,...i,onVisibleChange:n=>n?Z():V()});return e.createElement(e.Fragment,null,e.createElement(L,{...J,ref:M(w.refs.setPositionReference,s)},e.createElement(j,{...w.getReferenceProps(),tabIndex:0,role:"combobox",size:h,status:T,"aria-disabled":m?"true":void 0,"data-iui-disabled":m?"true":void 0,"aria-autocomplete":"none","aria-expanded":O,"aria-haspopup":"listbox","aria-controls":`${a}-menu`,styleType:G,...c,ref:M(q,c==null?void 0:c.ref,w.refs.setReference),className:k({"iui-placeholder":(!p||p.length===0)&&!!f},c==null?void 0:c.className)},(!p||p.length===0)&&e.createElement(S,{as:"span",className:"iui-content"},f),F(p,b)?e.createElement(Re,{selectedItems:p,selectedItemsRenderer:x,tagRenderer:ee}):e.createElement(we,{selectedItem:p,selectedItemRenderer:x})),e.createElement(U,{disabled:m,isOpen:O}),b?e.createElement(ye,{text:Q}):null),w.open&&e.createElement(de,null,e.createElement(ke,{defaultFocusedIndex:P,className:d,id:`${a}-menu`,key:`${a}-menu`,...w.getFloatingProps({style:v,onKeyDown:({key:n})=>{n==="Tab"&&V()}}),ref:w.refs.setFloating},_)))}),F=(t,s)=>s,xe=(t,s)=>!s,j=e.forwardRef((t,s)=>{const{size:a,status:l,styleType:r="default",...o}=t;return e.createElement(S,{"data-iui-size":a,"data-iui-status":l,"data-iui-variant":r!=="default"?r:void 0,...o,ref:s,className:k("iui-select-button","iui-field",t.className)})}),U=e.forwardRef((t,s)=>{const{disabled:a,isOpen:l,...r}=t;return e.createElement(Ee,{"aria-hidden":!0,...r,ref:s,className:k("iui-end-icon",{"iui-disabled":a,"iui-open":l},t.className)},e.createElement(he,null))}),we=({selectedItem:t,selectedItemRenderer:s})=>{const a=(t==null?void 0:t.startIcon)??(t==null?void 0:t.icon);return e.createElement(e.Fragment,null,t&&s&&s(t),t&&!s&&e.createElement(e.Fragment,null,a&&e.createElement(S,{as:"span",className:"iui-icon","aria-hidden":!0},a),e.createElement(S,{as:"span",className:"iui-content"},t.label)))},Re=({selectedItems:t,selectedItemsRenderer:s,tagRenderer:a})=>{const l=e.useMemo(()=>t?t.map(r=>a(r)):[],[t,a]);return e.createElement(e.Fragment,null,t&&s&&s(t),t&&!s&&e.createElement(S,{as:"span",className:"iui-content"},e.createElement(pe,{tags:l})))},ke=e.forwardRef((t,s)=>{const{defaultFocusedIndex:a=0,autoFocus:l=!0,children:r,className:o,...f}=t,[m,h]=e.useState(a),y=e.useCallback(d=>{queueMicrotask(()=>{const v=d==null?void 0:d.querySelector('[tabindex="0"]');v==null||v.focus()})},[]),x=e.useMemo(()=>e.Children.map(r,(d,v)=>e.isValidElement(d)?e.createElement(me,{key:v,render:d,ref:d.props.ref||d.ref}):d),[r]);return e.createElement(fe,{render:e.createElement(ge,{as:"div",className:k("iui-menu",o)}),orientation:"vertical",role:"listbox",activeIndex:m,onNavigate:h,ref:M(s,l?y:void 0),...f},x)});export{ye as A,L as I,Be as S,pe as a,K as b};
