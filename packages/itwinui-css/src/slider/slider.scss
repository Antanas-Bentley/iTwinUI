// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.
@use '../mixins';

// #region Slider container
.iui-slider-container {
  --_iui-slider-container-gap: var(--iui-size-s);
  --_iui-slider-tick-size: var(--iui-size-s);
  --_iui-slider-tick-thickness: 1px;

  display: grid;

  @supports selector(:has(+ *)) {
    &:has(.iui-slider[data-iui-orientation='horizontal']) {
      grid-template-columns: auto 1fr auto;

      .iui-slider {
        grid-row: 1;
        grid-column: 2;
      }

      .iui-slider-min,
      .iui-slider-max {
        min-inline-size: var(--iui-size-l); // TODO: Can this be removed and use grid-template-columns instead?
      }

      .iui-slider-min {
        grid-row: 1;
        margin-inline-end: var(--_iui-slider-container-gap);
        text-align: end;
      }

      .iui-slider-max {
        grid-row: 1;
        grid-column: 3;
        margin-inline-start: var(--_iui-slider-container-gap);
      }

      .iui-slider-ticks {
        grid-row: 2;
        grid-column: 2;
      }

      .iui-slider-tick {
        flex-direction: column;
        inline-size: var(--_iui-slider-tick-thickness);

        &::before {
          inline-size: var(--_iui-slider-tick-thickness);
          block-size: var(--_iui-slider-tick-size);
        }
      }
    }

    &:has(.iui-slider[data-iui-orientation='vertical']) {
      grid-template-rows: auto 1fr auto;
      row-gap: var(
        --_iui-slider-container-gap
      ); // Use gap on vertical & margin on horizontal to avoid ticks conflicting with other content.

      .iui-slider {
        grid-row: 2;
        grid-column: 1;
      }

      .iui-slider-min {
        grid-row: 3;
      }

      .iui-slider-max {
        grid-row: 1;
        grid-column: 1;
      }

      .iui-slider-min,
      .iui-slider-max {
        text-align: center;
      }

      .iui-slider-ticks {
        grid-row: 2;
        grid-column: 2;
        flex-direction: column-reverse;
      }

      .iui-slider-tick {
        block-size: var(--_iui-slider-tick-thickness);

        &::before {
          inline-size: var(--_iui-slider-tick-size);
          block-size: var(--_iui-slider-tick-thickness);
        }
      }
    }

    &:has(.iui-slider[data-iui-disabled='true']) {
      color: var(--iui-color-text-disabled);
    }
  }
}

.iui-slider-min,
.iui-slider-max {
  user-select: all;
  display: flex;
  justify-content: center;

  svg {
    @include mixins.iui-icon-style('m');
    @include mixins.iui-icon-color;
  }
}

.iui-slider-min {
  grid-column: 1;
}

.iui-slider-ticks {
  position: relative;
  display: flex;
  pointer-events: none;
  justify-content: space-between;
  user-select: none;
}

.iui-slider-tick {
  position: relative;
  display: flex;
  pointer-events: none;
  justify-content: center;
  align-items: center;
  color: var(--_iui-slider-tick-text-color);

  &::before {
    content: '';
    background-color: var(--iui-color-border);
    @media (forced-colors: active) {
      background-color: CanvasText;
    }
  }
}
// #endregion Slider container

// #region Slider
.iui-slider {
  --_iui-slider-rail-color: var(--iui-color-border);
  --_iui-slider-thumb-border-color: var(--iui-color-border-foreground);
  --_iui-slider-thumb-color: var(--iui-color-background);
  --_iui-slider-thumb-cursor: grab;
  --_iui-slider-thumb-size: var(--iui-size-m);
  --_iui-slider-track-color: var(--iui-color-border-accent);
  --_iui-slider-track-thickness: calc(var(--_iui-slider-thumb-size) * 0.25);

  display: grid;
  position: relative;
  cursor: pointer;
  isolation: isolate;

  &.iui-grabbing {
    cursor: grabbing;
  }

  &::before {
    content: '';
    display: flex;
    background-color: var(--_iui-slider-rail-color);
    @media (forced-colors: active) {
      --_iui-slider-rail-color: CanvasText;
    }
  }

  &[data-iui-orientation='horizontal'] {
    block-size: calc(var(--_iui-slider-thumb-size) + 2px);
    touch-action: pan-x;

    &::before,
    .iui-slider-track {
      block-size: var(--_iui-slider-track-thickness);
    }

    &::before {
      grid-row: 2;
      grid-column-start: 1;
      inline-size: 100%;
    }

    .iui-slider-track {
      grid-row: 2;
      grid-column-start: 1;
    }

    .iui-slider-thumb {
      transform: translateX(-50%);
    }
  }

  &[data-iui-orientation='vertical'] {
    inline-size: calc(var(--_iui-slider-thumb-size) + 2px);
    touch-action: pan-y;

    &::before,
    .iui-slider-track {
      inline-size: var(--_iui-slider-track-thickness);
    }

    &::before {
      grid-column: 2;
      grid-row-start: 1;
      block-size: 100%;
    }

    .iui-slider-track {
      grid-column: 2;
      grid-row-start: 1;
      align-self: end;
    }

    .iui-slider-thumb {
      transform: translate(-50%, 50%);
    }
  }

  &[data-iui-disabled='true'] {
    cursor: not-allowed;
    pointer-events: none;

    --_iui-slider-rail-color: var(--iui-color-background-disabled);
    --_iui-slider-track-color: var(--iui-color-border);
    @media (forced-colors: active) {
      --_iui-slider-track-color: GrayText;
    }
  }
}

.iui-slider-thumb {
  box-sizing: content-box;
  position: absolute;
  block-size: var(--_iui-slider-thumb-size);
  inline-size: var(--_iui-slider-thumb-size);
  border-radius: 100%;
  z-index: 1;
  cursor: var(--_iui-slider-thumb-cursor);
  @include mixins.iui-focus($thickness: 2px);
  background: var(--iui-color-background);
  border: 1px solid var(--iui-color-border-foreground);

  &:active {
    --_iui-slider-thumb-cursor: grabbing;
  }

  &[aria-disabled='true'] {
    border-color: var(--iui-color-border);
    background: var(--iui-color-border);
    --_iui-slider-thumb-cursor: not-allowed;

    @media (forced-colors: active) {
      border-color: GrayText;
      background: GrayText;
    }
  }
}

.iui-slider-track {
  pointer-events: none;
  background-color: var(--_iui-slider-track-color);

  @media (forced-colors: active) {
    --_iui-slider-track-color: Highlight;
  }
}
// #endregion Slider
