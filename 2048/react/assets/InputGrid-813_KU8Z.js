import{r as e,S as Te,B as se,c as oe,u as F,d as xe,o as re,m as Ce,P as qe,n as Me,v as We,g as je,z as He,x as Z}from"./index-BCHkuJyl.js";import{L as ye}from"./Label-BYaOw0Zo.js";import{I as Ne}from"./Input-Bdlj06wy.js";import{T as Ke}from"./Textarea-D67ucMdw.js";import{I as he}from"./Icon-DWlT_78v.js";import{I as me}from"./InputWithDecorations-fqC-TH-H.js";import{M as Ge}from"./MenuExtraContent-BSUQg2_c.js";import{a as Ue,I as pe,b as Je,A as Qe,S as ae}from"./Select-CPBr9jkJ.js";import{T as Xe}from"./Text-C-eJf1dY.js";import{u as Ye}from"./Popover-BZc5TGyx.js";import{S as Ze}from"./SvgCaretDownSmall-CwG0ulvl.js";import{u as _e}from"./useContainerWidth-RgtAV8f1.js";import{L as et}from"./List-CRJDY97C.js";import{u as tt}from"./VirtualScroll-CwhsJBLA.js";import{L as ne}from"./ListItem-DzNkp6A4.js";import{S as nt}from"./SvgCheckmark-CviqWwvx.js";const be=e.forwardRef((r,i)=>{const{children:c,startIcon:n,status:s,className:u,iconProps:a,contentProps:t,...l}=r,f=n??(s&&Te[s]()),y=n!==null&&!!f;return e.createElement(se,{className:oe("iui-status-message",u),"data-iui-status":s,ref:i,...l},y?e.createElement(he,{"aria-hidden":!0,...a},f):null,e.createElement(se,{...t},c))}),rt=e.forwardRef((r,i)=>{const{label:c,disabled:n,required:s,status:u,message:a,icon:t,isLabelInline:l,children:f,className:y,style:v,statusMessage:b,inputId:d,labelId:R,...N}=r;return e.createElement(se,{className:oe("iui-input-grid",y),"data-iui-status":u,"data-iui-label-placement":l?"inline":void 0,style:v,ref:i,...N},c&&e.createElement(ye,{as:d&&r.as!=="label"?"label":"div",required:s,disabled:n,htmlFor:d,id:R},c),f,b||a&&e.createElement(be,{startIcon:t,status:u},a))}),ie=e.createContext(void 0);ie.displayName="ComboBoxRefsContext";const U=e.createContext(void 0);U.displayName="ComboBoxStateContext";const Be=e.forwardRef((r,i)=>{const{className:c,children:n,disabled:s,isOpen:u,...a}=r;return e.createElement(he,{as:"span",ref:i,className:oe("iui-end-icon",{"iui-disabled":s,"iui-open":u},c),...a},n??e.createElement(Ze,{"aria-hidden":!0}))});Be.displayName="ComboBoxEndIcon";const Ve=e.forwardRef((r,i)=>{const{selectedItems:c=[],...n}=r;return e.createElement(Ue,{ref:i,tags:c,...n})});Ve.displayName="ComboBoxMultipleContainer";const Oe=e.forwardRef((r,i)=>{const{selectTags:c,size:n,style:s,...u}=r,{isOpen:a,id:t,focusedIndex:l,setFocusedIndex:f,enableVirtualization:y,multiple:v,onClickHandler:b,popover:d,show:R,hide:N}=F(U),{inputRef:T,menuRef:k,optionsExtraInfoRef:$}=F(ie),_=xe(T,d.refs.setReference,i),w=re(l??-1),O=g=>{var A,M;return((M=(A=k.current)==null?void 0:A.querySelector(`[data-iui-index="${g}"]`))==null?void 0:M.id)??""},I=e.useCallback(g=>{var M,P,W,j,H,K,J,Q,ee,te;const A=Object.keys($.current).length??0;if(!g.altKey)switch(g.key){case"ArrowDown":{if(g.preventDefault(),!a)return R();if(A===0)return;if(w.current===-1){const S=(M=k.current)==null?void 0:M.querySelector("[data-iui-index]");return f(Number((S==null?void 0:S.getAttribute("data-iui-index"))??0))}if(y&&!((W=(P=k.current)==null?void 0:P.querySelector(`[data-iui-index="${w.current}"]`))!=null&&W.nextElementSibling))return;let h=w.current;do{const S=(j=k.current)==null?void 0:j.querySelector(`[data-iui-index="${h}"]`),B=(S==null?void 0:S.nextElementSibling)??((H=k.current)==null?void 0:H.querySelector("[data-iui-index]"));if(h=Number(B==null?void 0:B.getAttribute("data-iui-index")),B)return f(h)}while(h!==w.current);break}case"ArrowUp":{if(g.preventDefault(),!a)return R();if(A===0||y&&!((J=(K=k.current)==null?void 0:K.querySelector(`[data-iui-index="${w.current}"]`))!=null&&J.previousElementSibling))return;if(w.current===-1)return f(((Q=Object.values($.current))==null?void 0:Q[A-1].__originalIndex)??-1);let h=w.current;do{const S=(ee=k.current)==null?void 0:ee.querySelector(`[data-iui-index="${h}"]`),B=(S==null?void 0:S.previousElementSibling)??((te=k.current)==null?void 0:te.querySelector("[data-iui-index]:last-of-type"));if(h=Number(B==null?void 0:B.getAttribute("data-iui-index")),B)return f(h)}while(h!==w.current);break}case"Enter":{g.preventDefault(),a?w.current>-1&&(b==null||b(w.current)):R();break}case"Escape":{g.preventDefault(),N();break}case"Tab":N();break}},[f,y,w,a,k,b,$,R,N]),L=e.useRef(!1),E=e.useCallback(()=>{L.current=a},[a]),q=e.useCallback(()=>{L.current?N():R(),L.current=!1},[N,R]),[le,C]=_e();return e.createElement(e.Fragment,null,e.createElement(Ne,{ref:_,"aria-expanded":a,"aria-activedescendant":a&&l!=null&&l>-1?O(l):void 0,role:"combobox","aria-controls":a?`${t}-list`:void 0,"aria-autocomplete":"list",spellCheck:!1,autoCapitalize:"none",autoCorrect:"off",style:{...v&&{paddingInlineStart:C+18},...s},"aria-describedby":v?`${t}-selected-live`:void 0,size:n,...d.getReferenceProps({...u,onPointerDown:Ce(r.onPointerDown,E),onClick:Ce(r.onClick,q),onKeyDown:Ce(r.onKeyDown,I)})}),v&&c?e.createElement(Ve,{ref:le,selectedItems:c,id:`${t}-selected-live`}):null)});Oe.displayName="ComboBoxInput";const $e=e.forwardRef((r,i)=>{const{className:c,status:n,message:s,children:u,...a}=r,{id:t}=F(U);return e.createElement(rt,{className:c,status:n,statusMessage:typeof s=="string"?e.createElement(be,{status:n},s):e.isValidElement(s)&&e.cloneElement(s,{status:n}),ref:i,...a,id:t},e.createElement(pe,null,u))});$e.displayName="ComboBoxInputContainer";const st=r=>{const{children:i,...c}=r,{filteredOptions:n,getMenuItem:s,focusedIndex:u}=F(U),{menuRef:a}=F(ie),t=e.useCallback(b=>n.length>0?s(n[b],b):i,[n,s,i]),l=e.useMemo(()=>{var d;const b=(d=a.current)==null?void 0:d.querySelector(`[data-iui-index="${u}"]`);return b?Number(b.getAttribute("data-iui-filtered-index")??u):u},[u,a]),{outerProps:f,innerProps:y,visibleChildren:v}=tt({itemsLength:n.length||1,itemRenderer:t,scrollToIndex:l});return e.createElement(se,{as:"div",...f,...c},e.createElement("div",{...y,ref:y.ref},v))},Le=e.forwardRef((r,i)=>{const{className:c,children:n,style:s,...u}=r,{id:a,enableVirtualization:t,popover:l}=F(U),{menuRef:f}=F(ie),y=xe(l.refs.setFloating,i,f);return l.open&&e.createElement(qe,{portal:!0},e.createElement(et,{as:"div",className:oe("iui-menu",c),id:`${a}-list`,role:"listbox",ref:y,...l.getFloatingProps({style:t?{maxInlineSize:0,...s}:s,...u})},t?e.createElement(st,null,n):n))});Le.displayName="ComboBoxMenu";const Ae=e.memo(e.forwardRef((r,i)=>{const{children:c,isSelected:n,disabled:s,value:u,onClick:a,sublabel:t,size:l=t?"large":"default",startIcon:f,endIcon:y,role:v="option",index:b,...d}=r,{focusedIndex:R,enableVirtualization:N}=F(U),k=xe(i,$=>{!N&&R===b&&($==null||$.scrollIntoView({block:"nearest"}))});return e.createElement(ne,{as:"div",actionable:!0,size:l,active:n,disabled:s,focused:R===b,ref:k,onClick:()=>a==null?void 0:a(u),role:v,tabIndex:v==="presentation"?void 0:-1,"aria-selected":n,"aria-disabled":s,"data-iui-index":b,...d},f&&e.createElement(ne.Icon,{as:"span","aria-hidden":!0},f),e.createElement(ne.Content,null,c,t&&e.createElement(ne.Description,null,t)),y||n&&e.createElement(ne.Icon,{as:"span","aria-hidden":!0},y??e.createElement(nt,null)))}));Ae.displayName="ComboBoxMenuItem";const G=(r,i)=>i&&(Array.isArray(r)||r===void 0),at=(r,i)=>!i,we=(r,i)=>r.id??`${i}-option-${r.label.replace(/\s/g,"-")}`,ge=e.forwardRef((r,i)=>{var ve;const c=Me(),{options:n,value:s,onChange:u,filterFunction:a,inputProps:t,endIconProps:l,dropdownMenuProps:f,emptyStateMessage:y="No options found",itemRenderer:v,enableVirtualization:b=!1,multiple:d=!1,onShow:R,onHide:N,id:T=t!=null&&t.id?`iui-${t.id}-cb`:c,defaultValue:k,...$}=r,_=e.useRef(null),w=e.useRef(null),O=re(u),I=re(n),L=e.useRef({});e.useEffect(()=>{L.current={}},[n]),n.length>0&&Object.keys(L.current).length===0&&n.forEach((o,m)=>{L.current[we(o,T)]={__originalIndex:m}});const[E,q]=We(k,s),le=e.useRef(s);e.useLayoutEffect(()=>{s!==le.current&&s===void 0&&(le.current=s,q(void 0))},[q,s]);const C=e.useMemo(()=>{if(G(E,d)){const o=[];return E==null||E.forEach(m=>{const x=n.findIndex(p=>p.value===m);x>-1&&o.push(x)}),o}else return n.findIndex(o=>o.value===E)},[d,n,E]),[g,A]=e.useState(!1),[M,P]=e.useState(-1),W=re(R),j=re(N),H=e.useCallback(()=>{var o;A(!0),(o=W.current)==null||o.call(W)},[W]),K=e.useCallback(()=>{var o;A(!1),(o=j.current)==null||o.call(j)},[j]);je(()=>{var o,m;g?((o=_.current)==null||o.focus(),d||(Q(I.current),P(C??-1))):(P(-1),G(C,d)||S(C>=0?(m=I.current[C])==null?void 0:m.label:""))},[g,d,I,C]);const[J,Q]=e.useState(n),ee=e.useCallback(()=>{var o;Q(n),G(C,d)?P(-1):P(C),!G(C,d)&&!g&&S(C>=0?(o=I.current[C])==null?void 0:o.label:"")},[g,d,n,I,C]),te=e.useRef(n);e.useEffect(()=>{n!==te.current&&(te.current=n,ee())},[ee,n]);const[h,S]=e.useState(((ve=t==null?void 0:t.value)==null?void 0:ve.toString())??""),[B,Pe]=e.useState(""),ze=e.useCallback(o=>{var x;const{value:m}=o.currentTarget;S(m),H(),Q((a==null?void 0:a(I.current,m))??I.current.filter(p=>p.label.toLowerCase().includes(m.toLowerCase()))),M!=-1&&P(-1),(x=t==null?void 0:t.onChange)==null||x.call(t,o)},[a,M,t,I,H]),ue=e.useCallback(o=>G(C,d)?!!C.includes(o):C===o,[d,C]),Ee=e.useCallback((o,m,x)=>{var p;return m==="added"?[...x??[],(p=I.current[o])==null?void 0:p.value]:(x??[]).filter(z=>{var V;return z!==((V=I.current[o])==null?void 0:V.value)})},[I]),Ie=e.useCallback((o,m,x)=>{var p,z,V,X;at(O.current,d)?(z=O.current)==null||z.call(O,(p=I.current[o])==null?void 0:p.value):m&&x&&((X=O.current)==null||X.call(O,x,{value:(V=I.current[o])==null?void 0:V.value,type:m}))},[d,O,I]),ce=e.useCallback(o=>{var m,x,p;if((m=_.current)==null||m.focus({preventScroll:!0}),!((x=I.current[o])!=null&&x.disabled))if(G(E,d)){const z=ue(o)?"removed":"added",V=Ee(o,z,E);q(V),Ie(o,z,V),Pe(V.map(X=>{var de;return(de=I.current.find(Y=>Y.value===X))==null?void 0:de.label}).filter(Boolean).join(", "))}else q((p=I.current[o])==null?void 0:p.value),K(),Ie(o)},[q,Ee,ue,d,Ie,E,I,K]),Se=e.useCallback((o,m)=>{const x=we(o,T),{__originalIndex:p}=L.current[x]??{__originalIndex:n.findIndex(D=>D.value===D.value)},{icon:z,startIcon:V,...X}=o,de=V??z,Y=v?v(o,{isFocused:M===p,isSelected:Array.isArray(C)?C.includes(p):C===p,index:p,id:x}):null;return Y?e.cloneElement(Y,{onClick:D=>{var Re,ke;ce(p),(ke=(Re=Y.props).onClick)==null||ke.call(Re,D)},focused:M===p,"data-iui-index":p,"data-iui-filtered-index":m,ref:He(Y.props.ref,D=>{!b&&M===p&&(D==null||D.scrollIntoView({block:"nearest"}))})}):e.createElement(Ae,{key:x,id:x,startIcon:de,...X,isSelected:ue(p),onClick:()=>{ce(p)},index:p,"data-iui-filtered-index":m},o.label)},[b,M,T,ue,v,ce,n,C]),De=e.useMemo(()=>e.createElement(e.Fragment,null,e.isValidElement(y)?y:e.createElement(Ge,null,e.createElement(Xe,{isMuted:!0},y))),[y]),Fe=Ye({visible:g,onVisibleChange:o=>o?H():K(),matchWidth:!0,closeOnOutsideClick:!0,interactions:{click:!1,focus:!0}});return e.createElement(ie.Provider,{value:{inputRef:_,menuRef:w,optionsExtraInfoRef:L}},e.createElement(U.Provider,{value:{id:T,isOpen:g,focusedIndex:M,setFocusedIndex:P,onClickHandler:ce,enableVirtualization:b,filteredOptions:J,getMenuItem:Se,multiple:d,popover:Fe,show:H,hide:K}},e.createElement($e,{ref:i,disabled:t==null?void 0:t.disabled,...$},e.createElement(e.Fragment,null,e.createElement(Oe,{value:h,disabled:t==null?void 0:t.disabled,...t,onChange:ze,selectTags:G(E,d)?E==null?void 0:E.map(o=>{const m=I.current.find(x=>x.value===o);if(m!=null)return e.createElement(Je,{key:m.label,label:m.label})}).filter(Boolean):void 0})),e.createElement(Be,{...l,disabled:t==null?void 0:t.disabled,isOpen:g}),d?e.createElement(Qe,{text:B}):null),e.createElement(Le,{as:"div",...f},J.length>0&&!b?J.map(Se):De)))}),kt=e.forwardRef((r,i)=>{const{children:c,className:n,labelPlacement:s=void 0,...u}=r,a=ot(c);return e.createElement(se,{className:oe("iui-input-grid",n),"data-iui-label-placement":s,ref:i,...u},a)}),ot=r=>{const{labelId:i,inputId:c,messageId:n}=it(r);return e.useMemo(()=>e.Children.map(r,s=>e.isValidElement(s)?s.type===ye||s.type==="label"?Z(s,u=>({...u.props,htmlFor:u.props.htmlFor||c,id:u.props.id||i})):s.type===be?Z(s,u=>({...u.props,id:u.props.id||n})):fe(s)||s.type===me||s.type===pe?lt(s,{labelId:i,inputId:c,messageId:n}):s:s),[r,c,i,n])},it=r=>{const i=Me();let c,n,s,u=!1,a=!1;const t=l=>{var f;if(e.isValidElement(l)){if(l.type===ge)return((f=l.props.inputProps)==null?void 0:f.id)||`${i}--input`;if(l.type!==ae)return l.props.id||`${i}--input`}};return e.Children.forEach(r,l=>{e.isValidElement(l)&&((l.type===ye||l.type==="label")&&(u=!0,c||(c=l.props.id||`${i}--label`)),l.type===be&&(s||(s=l.props.id||`${i}--message`)),l.type===me||l.type===pe?e.Children.forEach(l.props.children,f=>{fe(f)&&(n||(n=t(f)))}):fe(l)&&(n||(n=t(l))),l.type===ae&&(a=!0))}),{labelId:a?c:void 0,inputId:u&&!a?n:void 0,messageId:s}},lt=(r,{labelId:i,inputId:c,messageId:n})=>{const s=(a={})=>{const t=[a["aria-describedby"],n].filter(Boolean).join(" ");return{...a,...r.type!==ae&&{id:a.id||c},"aria-describedby":(t==null?void 0:t.trim())||void 0}},u=a=>a.type===ge?Z(a,t=>({inputProps:s(t.props.inputProps)})):a.type===ae?Z(a,t=>({triggerProps:{"aria-labelledby":i,...s(t.props.triggerProps)}})):Z(a,t=>s(t.props));return r.type===me||r.type===pe?Z(r,a=>({children:e.Children.map(a.props.children,t=>e.isValidElement(t)&&fe(t)?u(t):t)})):u(r)},fe=r=>e.isValidElement(r)&&(r.type==="input"||r.type==="textarea"||r.type==="select"||r.type===Ne||r.type===Ke||r.type===me.Input||r.type===ae||r.type===ge);export{ge as C,kt as I,be as S};
