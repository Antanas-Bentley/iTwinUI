import{r as e,S as ze,B as ee,c as ne,u as $,d as ye,o as _,m as be,P as De,n as ke,g as Pe,z as Te,x as J}from"./index-zHmCT5U4.js";import{L as Ie}from"./Label-C2RMpOkl.js";import{I as we}from"./Input-DPJ5b_lQ.js";import{T as qe}from"./Textarea-C49o5Kyq.js";import{I as Ne}from"./Icon-DKimvBJg.js";import{I as ce}from"./InputWithDecorations-BQcuCqgn.js";import{M as Fe}from"./MenuExtraContent-oLl5QYow.js";import{a as We,I as de,b as je,A as He,S as te}from"./Select-B0dFxYDX.js";import{T as Ke}from"./Text-DXpCDFd8.js";import{u as Ge}from"./Popover-Cnoss8g8.js";import{S as Ue}from"./SvgCaretDownSmall-CBc3KrM2.js";import{u as Je}from"./useContainerWidth-CRW8lY2-.js";import{L as Qe}from"./List-CQ9IThFS.js";import{u as Xe}from"./VirtualScroll-uBqxY0b1.js";import{L as Z}from"./ListItem-B2hEON3t.js";import{S as Ye}from"./SvgCheckmark-CVCtIHo4.js";const fe=e.forwardRef((t,i)=>{const{children:c,startIcon:s,status:r,className:u,iconProps:a,contentProps:n,...l}=t,m=s??(r&&ze[r]()),b=s!==null&&!!m;return e.createElement(ee,{className:ne("iui-status-message",u),"data-iui-status":r,ref:i,...l},b?e.createElement(Ne,{"aria-hidden":!0,...a},m):null,e.createElement(ee,{...n},c))}),Ze=e.forwardRef((t,i)=>{const{label:c,disabled:s,required:r,status:u,message:a,icon:n,isLabelInline:l,children:m,className:b,style:E,statusMessage:y,inputId:d,labelId:N,...B}=t;return e.createElement(ee,{className:ne("iui-input-grid",b),"data-iui-status":u,"data-iui-label-placement":l?"inline":void 0,style:E,ref:i,...B},c&&e.createElement(Ie,{as:d&&t.as!=="label"?"label":"div",required:r,disabled:s,htmlFor:d,id:N},c),m,y||a&&e.createElement(fe,{startIcon:n,status:u},a))}),_e=(t,i)=>{switch(i.type){case"open":return{...t,isOpen:!0};case"close":return{...t,isOpen:!1};case"select":return Array.isArray(t.selected)?{...t}:{...t,selected:i.value??t.selected,focusedIndex:i.value??t.focusedIndex};case"multiselect":return Array.isArray(t.selected)?{...t,selected:i.value}:{...t};case"focus":return Array.isArray(t.selected)?{...t,focusedIndex:i.value??-1}:{...t,focusedIndex:i.value??t.selected??-1};default:return t}},re=e.createContext(void 0);re.displayName="ComboBoxRefsContext";const H=e.createContext(void 0);H.displayName="ComboBoxStateContext";const xe=e.createContext(void 0);xe.displayName="ComboBoxActionContext";const he=e.forwardRef((t,i)=>{const{className:c,children:s,disabled:r,isOpen:u,...a}=t;return e.createElement(Ne,{as:"span",ref:i,className:ne("iui-end-icon",{"iui-disabled":r,"iui-open":u},c),...a},s??e.createElement(Ue,{"aria-hidden":!0}))});he.displayName="ComboBoxEndIcon";const Be=e.forwardRef((t,i)=>{const{selectedItems:c=[],...s}=t;return e.createElement(We,{ref:i,tags:c,...s})});Be.displayName="ComboBoxMultipleContainer";const Me=e.forwardRef((t,i)=>{const{selectTags:c,size:s,style:r,...u}=t,{isOpen:a,id:n,focusedIndex:l,enableVirtualization:m,multiple:b,onClickHandler:E,popover:y,show:d,hide:N}=$(H),B=$(xe),{inputRef:z,menuRef:k,optionsExtraInfoRef:M}=$(re),me=ye(z,y.refs.setReference,i),I=_(l??-1),g=w=>{var O,V;return((V=(O=k.current)==null?void 0:O.querySelector(`[data-iui-index="${w}"]`))==null?void 0:V.id)??""},D=e.useCallback(w=>{var V,T,K,q,F,X,se,ae,oe,W;const O=Object.keys(M.current).length??0;if(!w.altKey)switch(w.key){case"ArrowDown":{if(w.preventDefault(),!a)return d();if(O===0)return;if(I.current===-1){const v=(V=k.current)==null?void 0:V.querySelector("[data-iui-index]");return B({type:"focus",value:Number((v==null?void 0:v.getAttribute("data-iui-index"))??0)})}if(m&&!((K=(T=k.current)==null?void 0:T.querySelector(`[data-iui-index="${I.current}"]`))!=null&&K.nextElementSibling))return;let h=I.current;do{const v=(q=k.current)==null?void 0:q.querySelector(`[data-iui-index="${h}"]`),R=(v==null?void 0:v.nextElementSibling)??((F=k.current)==null?void 0:F.querySelector("[data-iui-index]"));if(h=Number(R==null?void 0:R.getAttribute("data-iui-index")),R)return B({type:"focus",value:h})}while(h!==I.current);break}case"ArrowUp":{if(w.preventDefault(),!a)return d();if(O===0||m&&!((se=(X=k.current)==null?void 0:X.querySelector(`[data-iui-index="${I.current}"]`))!=null&&se.previousElementSibling))return;if(I.current===-1)return B({type:"focus",value:((ae=Object.values(M.current))==null?void 0:ae[O-1].__originalIndex)??-1});let h=I.current;do{const v=(oe=k.current)==null?void 0:oe.querySelector(`[data-iui-index="${h}"]`),R=(v==null?void 0:v.previousElementSibling)??((W=k.current)==null?void 0:W.querySelector("[data-iui-index]:last-of-type"));if(h=Number(R==null?void 0:R.getAttribute("data-iui-index")),R)return B({type:"focus",value:h})}while(h!==I.current);break}case"Enter":{w.preventDefault(),a?I.current>-1&&(E==null||E(I.current)):d();break}case"Escape":{w.preventDefault(),N();break}case"Tab":N();break}},[B,m,I,a,k,E,M,d,N]),Q=e.useRef(!1),P=e.useCallback(()=>{Q.current=a},[a]),x=e.useCallback(()=>{Q.current?N():d(),Q.current=!1},[N,d]),[L,S]=Je();return e.createElement(e.Fragment,null,e.createElement(we,{ref:me,"aria-expanded":a,"aria-activedescendant":a&&l!=null&&l>-1?g(l):void 0,role:"combobox","aria-controls":a?`${n}-list`:void 0,"aria-autocomplete":"list",spellCheck:!1,autoCapitalize:"none",autoCorrect:"off",style:{...b&&{paddingInlineStart:S+18},...r},"aria-describedby":b?`${n}-selected-live`:void 0,size:s,...y.getReferenceProps({...u,onPointerDown:be(t.onPointerDown,P),onClick:be(t.onClick,x),onKeyDown:be(t.onKeyDown,D)})}),b&&c?e.createElement(Be,{ref:L,selectedItems:c,id:`${n}-selected-live`}):null)});Me.displayName="ComboBoxInput";const Oe=e.forwardRef((t,i)=>{const{className:c,status:s,message:r,children:u,...a}=t,{id:n}=$(H);return e.createElement(Ze,{className:c,status:s,statusMessage:typeof r=="string"?e.createElement(fe,{status:s},r):e.isValidElement(r)&&e.cloneElement(r,{status:s}),ref:i,...a,id:n},e.createElement(de,null,u))});Oe.displayName="ComboBoxInputContainer";const et=t=>{const{children:i,...c}=t,{filteredOptions:s,getMenuItem:r,focusedIndex:u}=$(H),{menuRef:a}=$(re),n=e.useCallback(y=>s.length>0?r(s[y],y):i,[s,r,i]),l=e.useMemo(()=>{var d;const y=(d=a.current)==null?void 0:d.querySelector(`[data-iui-index="${u}"]`);return y?Number(y.getAttribute("data-iui-filtered-index")??u):u},[u,a]),{outerProps:m,innerProps:b,visibleChildren:E}=Xe({itemsLength:s.length||1,itemRenderer:n,scrollToIndex:l});return e.createElement(ee,{as:"div",...m,...c},e.createElement("div",{...b,ref:b.ref},E))},Ve=e.forwardRef((t,i)=>{const{className:c,children:s,style:r,...u}=t,{id:a,enableVirtualization:n,popover:l}=$(H),{menuRef:m}=$(re),b=ye(l.refs.setFloating,i,m);return l.open&&e.createElement(De,{portal:!0},e.createElement(Qe,{as:"div",className:ne("iui-menu",c),id:`${a}-list`,role:"listbox",ref:b,...l.getFloatingProps({style:n?{maxInlineSize:0,...r}:r,...u})},n?e.createElement(et,null,s):s))});Ve.displayName="ComboBoxMenu";const Le=e.memo(e.forwardRef((t,i)=>{const{children:c,isSelected:s,disabled:r,value:u,onClick:a,sublabel:n,size:l=n?"large":"default",startIcon:m,endIcon:b,role:E="option",index:y,...d}=t,{focusedIndex:N,enableVirtualization:B}=$(H),k=ye(i,M=>{!B&&N===y&&(M==null||M.scrollIntoView({block:"nearest"}))});return e.createElement(Z,{as:"div",actionable:!0,size:l,active:s,disabled:r,focused:N===y,ref:k,onClick:()=>a==null?void 0:a(u),role:E,tabIndex:E==="presentation"?void 0:-1,"aria-selected":s,"aria-disabled":r,"data-iui-index":y,...d},m&&e.createElement(Z.Icon,{as:"span","aria-hidden":!0},m),e.createElement(Z.Content,null,c,n&&e.createElement(Z.Description,null,n)),b||s&&e.createElement(Z.Icon,{as:"span","aria-hidden":!0},b??e.createElement(Ye,null)))}));Le.displayName="ComboBoxMenuItem";const U=(t,i)=>i&&(Array.isArray(t)||t===void 0),tt=(t,i)=>!i,Re=(t,i)=>t.id??`${i}-option-${t.label.replace(/\s/g,"-")}`,Ce=e.forwardRef((t,i)=>{var Ee;const c=ke(),{options:s,value:r,onChange:u,filterFunction:a,inputProps:n,endIconProps:l,dropdownMenuProps:m,emptyStateMessage:b="No options found",itemRenderer:E,enableVirtualization:y=!1,multiple:d=!1,onShow:N,onHide:B,id:z=n!=null&&n.id?`iui-${n.id}-cb`:c,...k}=t,M=e.useRef(null),me=e.useRef(null),I=_(u),g=_(s),D=e.useRef({});e.useEffect(()=>{D.current={}},[s]),s.length>0&&Object.keys(D.current).length===0&&s.forEach((o,f)=>{D.current[Re(o,z)]={__originalIndex:f}});const Q=e.useCallback(()=>{if(U(r,d)){const o=[];return r==null||r.forEach(f=>{const p=s.findIndex(C=>C.value===f);p>-1&&o.push(p)}),o}else return s.findIndex(o=>o.value===r)},[d,s,r]),[{isOpen:P,selected:x,focusedIndex:L},S]=e.useReducer(_e,{isOpen:!1,selected:Q(),focusedIndex:-1}),w=_(N),O=_(B),V=e.useCallback(()=>{var o;S({type:"open"}),(o=w.current)==null||o.call(w)},[w]),T=e.useCallback(()=>{var o;S({type:"close"}),(o=O.current)==null||o.call(O)},[O]);Pe(()=>{var o,f;P?((o=M.current)==null||o.focus(),d||(q(g.current),S({type:"focus",value:void 0}))):(S({type:"focus",value:void 0}),U(x,d)||X(x!=null&&x>=0?(f=g.current[x])==null?void 0:f.label:""))},[P,d,g,x]);const[K,q]=e.useState(s);e.useEffect(()=>{q(F?(a==null?void 0:a(s,F))??s.filter(o=>o.label.toLowerCase().includes(F.toLowerCase())):s),S({type:"focus",value:void 0})},[s]);const[F,X]=e.useState(((Ee=n==null?void 0:n.value)==null?void 0:Ee.toString())??""),[se,ae]=e.useState(""),oe=e.useCallback(o=>{var p;const{value:f}=o.currentTarget;X(f),V(),q((a==null?void 0:a(g.current,f))??g.current.filter(C=>C.label.toLowerCase().includes(f.toLowerCase()))),L!=-1&&S({type:"focus",value:-1}),(p=n==null?void 0:n.onChange)==null||p.call(n,o)},[a,L,n,g,V]);e.useEffect(()=>{if(U(r,d))if(r){const o=r.map(f=>s.findIndex(p=>p.value===f));S({type:"multiselect",value:o.filter(f=>f!==-1)})}else S({type:"multiselect",value:[]});else S({type:"select",value:s.findIndex(o=>o.value===r)})},[r,s,d]);const W=e.useCallback(o=>U(x,d)?!!x.includes(o):x===o,[d,x]),h=e.useCallback((o,f)=>f==="added"?[...x,o]:x.filter(p=>p!==o),[x]),v=e.useCallback((o,f,p)=>{var C,A,G,j;tt(I.current,d)?(A=I.current)==null||A.call(I,(C=g.current[o])==null?void 0:C.value):f&&p&&((j=I.current)==null||j.call(I,p==null?void 0:p.map(pe=>{var ie;return(ie=g.current[pe])==null?void 0:ie.value}),{value:(G=g.current[o])==null?void 0:G.value,type:f}))},[d,I,g]),R=e.useCallback(o=>{var f,p;if((f=M.current)==null||f.focus({preventScroll:!0}),!((p=g.current[o])!=null&&p.disabled))if(U(x,d)){const C=W(o)?"removed":"added",A=h(o,C);S({type:"multiselect",value:A}),v(o,C,A),ae(A.map(G=>{var j;return(j=g.current[G])==null?void 0:j.label}).filter(Boolean).join(", "))}else S({type:"select",value:o}),T(),v(o)},[h,W,d,v,x,g,T]),ge=e.useCallback((o,f)=>{const p=Re(o,z),{__originalIndex:C}=D.current[p],{icon:A,startIcon:G,label:j,...pe}=o,ie=G??A,le=E?E(o,{isFocused:L===C,isSelected:x===C,index:C,id:p}):null;return le?e.cloneElement(le,{onClick:Y=>{var ve,Se;R(C),(Se=(ve=le.props).onClick)==null||Se.call(ve,Y)},focused:L===C,"data-iui-index":C,"data-iui-filtered-index":f,ref:Te(le.props.ref,Y=>{!y&&L===C&&(Y==null||Y.scrollIntoView({block:"nearest"}))})}):e.createElement(Le,{key:p,id:p,startIcon:ie,...pe,isSelected:W(C),onClick:()=>{R(C)},index:C,"data-iui-filtered-index":f},j)},[y,L,z,W,E,R,x]),$e=e.useMemo(()=>e.createElement(e.Fragment,null,e.isValidElement(b)?b:e.createElement(Fe,null,e.createElement(Ke,{isMuted:!0},b))),[b]),Ae=Ge({visible:P,onVisibleChange:o=>o?V():T(),matchWidth:!0,closeOnOutsideClick:!0,interactions:{click:!1,focus:!0}});return e.createElement(re.Provider,{value:{inputRef:M,menuRef:me,optionsExtraInfoRef:D}},e.createElement(xe.Provider,{value:S},e.createElement(H.Provider,{value:{id:z,isOpen:P,focusedIndex:L,onClickHandler:R,enableVirtualization:y,filteredOptions:K,getMenuItem:ge,multiple:d,popover:Ae,show:V,hide:T}},e.createElement(Oe,{ref:i,disabled:n==null?void 0:n.disabled,...k},e.createElement(e.Fragment,null,e.createElement(Me,{value:F,disabled:n==null?void 0:n.disabled,...n,onChange:oe,selectTags:U(x,d)?x.map(o=>{const f=g.current[o];return e.createElement(je,{key:f.label,label:f.label})}):void 0})),e.createElement(he,{...l,disabled:n==null?void 0:n.disabled,isOpen:P}),d?e.createElement(He,{text:se}):null),e.createElement(Ve,{as:"div",...m},K.length>0&&!y?K.map(ge):$e))))}),Et=e.forwardRef((t,i)=>{const{children:c,className:s,labelPlacement:r=void 0,...u}=t,a=nt(c);return e.createElement(ee,{className:ne("iui-input-grid",s),"data-iui-label-placement":r,ref:i,...u},a)}),nt=t=>{const{labelId:i,inputId:c,messageId:s}=rt(t);return e.useMemo(()=>e.Children.map(t,r=>e.isValidElement(r)?r.type===Ie||r.type==="label"?J(r,u=>({...u.props,htmlFor:u.props.htmlFor||c,id:u.props.id||i})):r.type===fe?J(r,u=>({...u.props,id:u.props.id||s})):ue(r)||r.type===ce||r.type===de?st(r,{labelId:i,inputId:c,messageId:s}):r:r),[t,c,i,s])},rt=t=>{const i=ke();let c,s,r,u=!1,a=!1;const n=l=>{var m;if(e.isValidElement(l)){if(l.type===Ce)return((m=l.props.inputProps)==null?void 0:m.id)||`${i}--input`;if(l.type!==te)return l.props.id||`${i}--input`}};return e.Children.forEach(t,l=>{e.isValidElement(l)&&((l.type===Ie||l.type==="label")&&(u=!0,c||(c=l.props.id||`${i}--label`)),l.type===fe&&(r||(r=l.props.id||`${i}--message`)),l.type===ce||l.type===de?e.Children.forEach(l.props.children,m=>{ue(m)&&(s||(s=n(m)))}):ue(l)&&(s||(s=n(l))),l.type===te&&(a=!0))}),{labelId:a?c:void 0,inputId:u&&!a?s:void 0,messageId:r}},st=(t,{labelId:i,inputId:c,messageId:s})=>{const r=(a={})=>{const n=[a["aria-describedby"],s].filter(Boolean).join(" ");return{...a,...t.type!==te&&{id:a.id||c},"aria-describedby":(n==null?void 0:n.trim())||void 0}},u=a=>a.type===Ce?J(a,n=>({inputProps:r(n.props.inputProps)})):a.type===te?J(a,n=>({triggerProps:{"aria-labelledby":i,...r(n.props.triggerProps)}})):J(a,n=>r(n.props));return t.type===ce||t.type===de?J(t,a=>({children:e.Children.map(a.props.children,n=>e.isValidElement(n)&&ue(n)?u(n):n)})):u(t)},ue=t=>e.isValidElement(t)&&(t.type==="input"||t.type==="textarea"||t.type==="select"||t.type===we||t.type===qe||t.type===ce.Input||t.type===te||t.type===Ce);export{Ce as C,Et as I,fe as S};
