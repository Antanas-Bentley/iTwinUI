import{r,q as le,p as ne,B as w,c as y,z as re,I as de,R as o,j as x}from"./index-DfTeYc2P.js";import{S as F}from"./Placeholder-CmC8obpM.js";import{g as q}from"./focusable-DQv_vybo.js";import{u as ce}from"./VirtualScroll-4Qm6jQCb.js";import{S as ue}from"./SvgChevronRight-BnJpeYeh.js";import{C as U}from"./Checkbox-Bwq9KvPx.js";import{P as ie}from"./ProgressRadial-a6kLpYgs.js";const be=b=>r.createElement(le,{...b},r.createElement("path",{d:"m5.525 2-1.05 1.05L9.425 8l-4.95 4.95L5.525 14l6-6-6-6Z"})),W=r.createContext(void 0),Ne=()=>{const b=r.useContext(W);if(b==null)throw new Error("TreeContext must be used within a TreeContext.Provider");return b},P=b=>{const{data:c,className:N,nodeRenderer:i,getNode:f,size:p="default",enableVirtualization:t=!1,style:n,...u}=b,m=r.useRef(null),e=r.useRef(0);r.useEffect(()=>{e.current=0},[c]);const s=r.useCallback(()=>{const E=q(m.current);return E.filter(d=>!E.some(g=>g.contains(d.parentElement)))},[]),a=E=>{if(E.altKey)return;const d=s();if(!(d!=null&&d.length))return;const g=d.findIndex(S=>{var v;return S.contains((v=m.current)==null?void 0:v.ownerDocument.activeElement)}),$=g>-1?g:0;switch(E.key){case"ArrowUp":{E.preventDefault();const S=Math.max(0,$-1);d[S].focus(),e.current=S;break}case"ArrowDown":{E.preventDefault();const S=Math.min(d.length-1,$+1);d[S].focus(),e.current=S;break}}},[l,h]=r.useMemo(()=>{const E=[],d=[],g=($=[],S=0,v)=>{const M=Array();return $.forEach((_,L)=>{const{subNodes:G,...O}=f(_),j={nodeProps:O,depth:S,parentNode:v,indexInGroup:L};if(M.push(j.nodeProps.nodeId),E.push(j),S===0&&d.push(j),j.nodeProps.isExpanded){const B=g(G,S+1,j);j.subNodeIds=B}}),M};return g(c),[E,d]},[c,f]),k=r.useCallback(E=>{var g,$,S;const d=l[E];return r.createElement(W.Provider,{key:d.nodeProps.nodeId,value:{nodeDepth:d.depth,subNodeIds:d.subNodeIds,groupSize:d.depth===0?h.length:(($=(g=d.parentNode)==null?void 0:g.subNodeIds)==null?void 0:$.length)??0,indexInGroup:d.indexInGroup,parentNodeId:(S=d.parentNode)==null?void 0:S.nodeProps.nodeId,scrollToParent:d.parentNode?()=>{var _;const v=(_=d.parentNode)==null?void 0:_.nodeProps.nodeId,M=l.findIndex(L=>L.nodeProps.nodeId===v);R(M)}:void 0,size:p}},i(d.nodeProps))},[h.length,l,i,p]),[C,R]=r.useState(),A=r.useRef(l);r.useEffect(()=>{A.current=l},[l]),r.useEffect(()=>{setTimeout(()=>{var E;if(C!==void 0){const d=A.current[C].nodeProps.nodeId,g=(E=m.current)==null?void 0:E.ownerDocument.querySelector(`#${d}`);g==null||g.focus(),R(void 0)}})},[C]);const z=E=>{var g,$;if((g=m.current)!=null&&g.contains(E.relatedTarget))return;const d=s();d.length>0&&(($=d[e.current])==null||$.focus())};return r.createElement(r.Fragment,null,t?r.createElement(me,{flatNodesList:l,itemRenderer:k,scrollToIndex:C,onFocus:z,onKeyDown:a,ref:m,className:N,style:n,...u}):r.createElement(se,{onKeyDown:a,onFocus:z,className:N,"data-iui-size":p==="small"?"small":void 0,style:n,ref:m,...u},l.map((E,d)=>k(d))))},se=ne.ul("iui-tree",{role:"tree",tabIndex:0}),me=r.forwardRef(({flatNodesList:b,itemRenderer:c,scrollToIndex:N,className:i,style:f,...p},t)=>{const{outerProps:n,innerProps:u,visibleChildren:m}=ce({itemsLength:b.length,itemRenderer:c,scrollToIndex:N});return r.createElement(w,{...n,className:y(i,n.className),style:{...f,...n.style}},r.createElement(se,{...u,...p,ref:re(t,u.ref)},m))}),te=r.forwardRef((b,c)=>{var n;const{isExpanded:N,expanderIconProps:i={},...f}=b,t=(((n=r.useContext(W))==null?void 0:n.size)??"default")==="small"?be:ue;return r.createElement(de,{styleType:"borderless",size:"small","aria-label":N?"Collapse":"Expand",ref:c,...f},r.createElement(t,{...i,className:y("iui-tree-node-content-expander-icon",i==null?void 0:i.className,{"iui-tree-node-content-expander-icon-expanded":N})}))}),V=b=>{const{nodeId:c,nodeProps:N={},label:i,labelProps:f={},sublabel:p,sublabelProps:t={},children:n,className:u,icon:m,iconProps:e={},hasSubNodes:s=!1,isDisabled:a=!1,isExpanded:l=!1,isSelected:h=!1,onSelected:k,onExpanded:C,checkbox:R,checkboxProps:A={},subTreeProps:z={},contentProps:E={},titleProps:d={},expanderProps:g={},expander:$,...S}=b,{nodeDepth:v,subNodeIds:M=[],parentNodeId:_,scrollToParent:L,groupSize:G,indexInGroup:O}=Ne(),[j,B]=r.useState(!1),D=r.useRef(null),ae=I=>{var H,J,Q,X,Y,ee;if(I.altKey)return;const Z=D.current===((H=D.current)==null?void 0:H.ownerDocument.activeElement);switch(I.key){case"ArrowLeft":{if(I.preventDefault(),Z){if(l){C(c,!1);break}if(_){L==null||L();break}break}const T=q(D.current),K=T.indexOf((J=D.current)==null?void 0:J.ownerDocument.activeElement);K===0?(Q=D.current)==null||Q.focus():(X=T[K-1])==null||X.focus();break}case"ArrowRight":{I.preventDefault();const T=q(D.current);if(Z){if(!l&&s){C(c,!0);break}(Y=T[0])==null||Y.focus();break}const K=T.indexOf((ee=D.current)==null?void 0:ee.ownerDocument.activeElement);if(K<T.length-1){T[K+1].focus();break}break}case" ":case"Spacebar":case"Enter":{if(I.target!==D.current)break;I.preventDefault(),a||k==null||k(c,!h);break}}},oe=r.useCallback(I=>{C(c,!l),I.stopPropagation()},[l,c,C]);return r.createElement(w,{as:"li",role:"treeitem",className:y("iui-tree-item",u),id:c,"aria-expanded":s?l:void 0,"aria-disabled":a,"aria-selected":h,"aria-level":v+1,"aria-setsize":G,"aria-posinset":O+1,tabIndex:-1,onFocus:I=>{B(!0),I.stopPropagation()},onBlur:()=>{B(!1)},ref:D,onKeyDown:ae,...S},r.createElement(w,{as:"div",style:{"--level":v},onClick:()=>!a&&(k==null?void 0:k(c,!h)),...N,className:y("iui-tree-node",{"iui-active":h,"iui-disabled":a},N==null?void 0:N.className)},R&&r.createElement(w,{as:"div",...A,className:y("iui-tree-node-checkbox",A==null?void 0:A.className)},r.isValidElement(R)?r.cloneElement(R,{tabIndex:j?0:-1}):R),r.createElement(w,{as:"div",...E,className:y("iui-tree-node-content",E==null?void 0:E.className)},s&&$,s&&!$&&r.createElement(te,{isExpanded:l,disabled:a,onClick:oe,tabIndex:j?0:-1,...g}),m&&r.createElement(w,{as:"span","aria-hidden":!0,...e,className:y("iui-tree-node-content-icon",e==null?void 0:e.className)},m),r.createElement(w,{as:"div",...f,className:y("iui-tree-node-content-label",f==null?void 0:f.className)},r.createElement(w,{as:"div",...d,className:y("iui-tree-node-content-title",d==null?void 0:d.className)},i),p&&r.createElement(w,{as:"div",...t,className:y("iui-tree-node-content-caption",t==null?void 0:t.className)},p)),n)),s&&r.createElement(w,{as:"ul",role:"group","aria-owns":M.join(" "),...z,className:y("iui-sub-tree",z==null?void 0:z.className)}))},Se={title:"Tree"},Ce=()=>{const[b,c]=o.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),N=o.useCallback((t,n)=>{n?(c(u=>({...u,[t]:!0})),console.log(`Expanded node ${t}`)):(c(u=>({...u,[t]:!1})),console.log(`Closed node ${t}`))},[]),i=o.useCallback((t,n="",u=0)=>{const m=n?`${n}-${t}`:`${t}`;return{id:`Node-${m}`,label:`Node ${m}`,sublabel:`Sublabel for Node ${m}`,subItems:u<10?Array(Math.round(t%5)).fill(null).map((e,s)=>i(s,m,u+1)):[]}},[]),f=o.useMemo(()=>Array(8).fill(null).map((t,n)=>i(n)),[i]),p=o.useCallback(t=>({subNodes:t.subItems,nodeId:t.id,node:t,isExpanded:b[t.id],hasSubNodes:t.subItems.length>0}),[b]);return x.jsx(P,{data:f,getNode:p,nodeRenderer:o.useCallback(({node:t,...n})=>x.jsx(V,{label:t.label,sublabel:t.sublabel,onExpanded:N,icon:x.jsx(F,{}),...n}),[N])})},$e=()=>{const[b,c]=o.useState({"Node-0":!0,"Node-3-2":!0,"Node-22":!0}),N=o.useCallback((e,s)=>{s?(c(a=>({...a,[e]:!0})),console.log(`Selected node ${e}`)):(c(a=>({...a,[e]:!1})),console.log(`Unselected node ${e}`))},[]),[i,f]=o.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),p=o.useCallback((e,s)=>{s?(f(a=>({...a,[e]:!0})),console.log(`Expanded node ${e}`)):(f(a=>({...a,[e]:!1})),console.log(`Closed node ${e}`))},[]),[t]=o.useState({"Node-4":!0,"Node-3-0":!0,"Node-6":!0,"Node-10":!0}),n=o.useCallback((e,s="",a=0)=>{const l=s?`${s}-${e}`:`${e}`;return{id:`Node-${l}`,label:`Node ${l}`,sublabel:`Sublabel for Node ${l}`,subItems:a<10?Array(Math.round(e%5)).fill(null).map((h,k)=>n(k,l,a+1)):[]}},[]),u=o.useMemo(()=>Array(8).fill(null).map((e,s)=>n(s)),[n]),m=o.useCallback(e=>({subNodes:e.subItems,nodeId:e.id,node:e,isExpanded:i[e.id],isDisabled:t[e.id],isSelected:b[e.id],hasSubNodes:e.subItems.length>0}),[t,i,b]);return x.jsx(P,{data:u,getNode:m,nodeRenderer:o.useCallback(({node:e,...s})=>x.jsx(V,{label:e.label,sublabel:e.sublabel,onExpanded:p,onSelected:N,checkbox:x.jsx(U,{variant:"eyeball",disabled:s.isDisabled}),icon:x.jsx(F,{}),...s}),[p,N])})},ye=()=>{const b=o.useCallback(e=>({id:`Node-${e}`,label:`Node ${e}`,subItems:[],hasSubNodes:!0}),[]),[c,N]=o.useState(()=>Array(8).fill(null).map((e,s)=>b(s))),[i,f]=o.useState({}),p=o.useCallback((e,s)=>{s?(f(a=>({...a,[e]:!0})),console.log(`Selected node ${e}`)):(f(a=>({...a,[e]:!1})),console.log(`Unselected node ${e}`))},[]),[t,n]=o.useState({}),u=o.useCallback((e,s,a)=>{s&&!a.subItems.length&&a.hasSubNodes&&setTimeout(()=>{N(l=>{const h=[...l],k=h.find(C=>C.id===e);return k?(k.subItems=[{id:`Async-${e}`,label:`Async ${e}`,subItems:[]}],h):l})},1e3),s?(n(l=>({...l,[e]:!0})),console.log(`Expanded node ${e}`)):(n(l=>({...l,[e]:!1})),console.log(`Closed node ${e}`))},[]),m=o.useCallback(e=>({subNodes:!e.subItems.length&&e.hasSubNodes?[{id:`Async-${e.id}`,label:"",subItems:[],isLoading:!0}]:e.subItems,nodeId:e.id,node:e,isExpanded:t[e.id],isSelected:i[e.id],hasSubNodes:!!e.hasSubNodes}),[t,i]);return x.jsx(P,{data:c,getNode:m,nodeRenderer:o.useCallback(({node:e,...s})=>x.jsx(V,{label:e.isLoading?"Loading...":e.label,onExpanded:(a,l)=>u(a,l,e),onSelected:p,checkbox:x.jsx(U,{variant:"eyeball",disabled:s.isDisabled}),icon:e.isLoading?x.jsx(ie,{size:"x-small",indeterminate:!0}):x.jsx(F,{}),...s}),[u,p])})},Ie=()=>{const[b,c]=o.useState({"Node-0":!0,"Node-3-2":!0,"Node-22":!0}),N=o.useCallback((s,a)=>{a?(c(l=>({...l,[s]:!0})),console.log(`Selected node ${s}`)):(c(l=>({...l,[s]:!1})),console.log(`Unselected node ${s}`))},[]),[i,f]=o.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),p=o.useCallback((s,a)=>{a?(f(l=>({...l,[s]:!0})),console.log(`Expanded node ${s}`)):(f(l=>({...l,[s]:!1})),console.log(`Closed node ${s}`))},[]),[t]=o.useState({"Node-4":!0,"Node-3":!0,"Node-6":!0,"Node-10":!0}),n=o.useCallback(s=>Object.keys(t).some(a=>s===a||s.startsWith(`${a}-`)),[t]),u=o.useCallback((s,a="",l=0)=>{const h=a?`${a}-${s}`:`${s}`;return{id:`Node-${h}`,label:`Node ${h}`,sublabel:`Sublabel for Node ${h}`,subItems:l<10?Array(Math.round(s%5)).fill(null).map((k,C)=>u(C,h,l+1)):[]}},[]),m=o.useMemo(()=>Array(8).fill(null).map((s,a)=>u(a)),[u]),e=o.useCallback(s=>({subNodes:s.subItems,nodeId:s.id,node:s,isExpanded:i[s.id],isDisabled:n(s.id),isSelected:b[s.id],hasSubNodes:s.subItems.length>0}),[i,n,b]);return x.jsx(P,{data:m,getNode:e,nodeRenderer:o.useCallback(({node:s,...a})=>x.jsx(V,{label:s.label,sublabel:s.sublabel,onExpanded:p,onSelected:N,checkbox:x.jsx(U,{variant:"eyeball",disabled:a.isDisabled}),icon:x.jsx(F,{}),expander:x.jsx(te,{isExpanded:a.isExpanded,onClick:l=>{p(s.id,!a.isExpanded),l.stopPropagation()}}),...a}),[p,N])})},we=()=>{const[b,c]=o.useState({"Node-0":!0,"Node-3-2":!0,"Node-22":!0}),N=o.useCallback((e,s)=>{s?(c(a=>({...a,[e]:!0})),console.log(`Selected node ${e}`)):(c(a=>({...a,[e]:!1})),console.log(`Unselected node ${e}`))},[]),[i,f]=o.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),p=o.useCallback((e,s)=>{s?(f(a=>({...a,[e]:!0})),console.log(`Expanded node ${e}`)):(f(a=>({...a,[e]:!1})),console.log(`Closed node ${e}`))},[]),[t]=o.useState({"Node-4":!0,"Node-3-0":!0,"Node-6":!0,"Node-10":!0}),n=o.useCallback((e,s="",a=0)=>{const l=s?`${s}-${e}`:`${e}`;return{id:`Node-${l}`,label:`Node ${l}`,sublabel:`Sublabel for Node ${l}`,subItems:a<10?Array(Math.round(e%5)).fill(null).map((h,k)=>n(k,l,a+1)):[]}},[]),u=o.useMemo(()=>Array(1e5).fill(null).map((e,s)=>n(s)),[n]),m=o.useCallback(e=>({subNodes:e.subItems,nodeId:e.id,node:e,isExpanded:i[e.id],isDisabled:t[e.id],isSelected:b[e.id],hasSubNodes:e.subItems.length>0}),[t,i,b]);return x.jsx("div",{style:{height:"min(400px, 90vh)",overflow:"auto"},children:x.jsx(P,{data:u,getNode:m,enableVirtualization:!0,nodeRenderer:o.useCallback(({node:e,...s})=>x.jsx(V,{label:e.label,sublabel:e.sublabel,onExpanded:p,onSelected:N,checkbox:x.jsx(U,{variant:"eyeball",disabled:s.isDisabled}),icon:x.jsx(F,{}),...s}),[p,N])})})},ve=()=>{const[b,c]=o.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),N=o.useCallback((t,n)=>{n?(c(u=>({...u,[t]:!0})),console.log(`Expanded node ${t}`)):(c(u=>({...u,[t]:!1})),console.log(`Closed node ${t}`))},[]),i=o.useCallback((t,n="",u=0)=>{const m=n?`${n}-${t}`:`${t}`;return{id:`Node-${m}`,label:`Node ${m}`,sublabel:`Sublabel for Node ${m}`,subItems:u<10?Array(Math.round(t%5)).fill(null).map((e,s)=>i(s,m,u+1)):[]}},[]),f=o.useMemo(()=>Array(8).fill(null).map((t,n)=>i(n)),[i]),p=o.useCallback(t=>({subNodes:t.subItems,nodeId:t.id,node:t,isExpanded:b[t.id],hasSubNodes:t.subItems.length>0}),[b]);return x.jsx(P,{data:f,size:"small",getNode:p,nodeRenderer:o.useCallback(({node:t,...n})=>x.jsx(V,{label:t.label,sublabel:t.sublabel,onExpanded:N,icon:x.jsx(F,{}),...n}),[N])})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{ye as AsyncLoading,Ce as Basic,Ie as CustomizedExpander,$e as Full,ve as Small,we as Virtualized,Se as default};
